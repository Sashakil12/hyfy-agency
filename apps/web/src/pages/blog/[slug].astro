---
import '../../styles/global.css';
import { getBlogPost, getBlogPosts, getImageUrl, formatDate, parseMarkdown } from '../../lib/strapi';
import GlobalHeader from '../../components/GlobalHeader';

// Enable SSG for individual blog posts
export async function getStaticPaths() {
  try {
    // Fetch all blog posts to generate static paths
    const response = await getBlogPosts(1, 100); // Fetch up to 100 posts

    return response.data.map((post) => ({
      params: { slug: post.slug },
    }));
  } catch (error) {
    console.error('Error generating static paths:', error);
    return [];
  }
}

const { slug } = Astro.params;

if (!slug) {
  return Astro.redirect('/404');
}

const post = await getBlogPost(slug);

if (!post) {
  return Astro.redirect('/404');
}

const imageUrl = getImageUrl(post.featuredImage);
const formattedDate = formatDate(post.publishedDate);

// Parse markdown content to HTML
const contentHtml = await parseMarkdown(post.content);

// SEO Data
const pageTitle = post.seo?.metaTitle || `${post.title} | HyFy Blog`;
const pageDescription = post.seo?.metaDescription || post.excerpt;
const ogImage = post.seo?.metaImage ? getImageUrl(post.seo.metaImage) : imageUrl;
const canonicalUrl = post.seo?.canonicalURL || `${Astro.url.origin}/blog/${post.slug}`;
const keywords = post.seo?.keywords || (post.tags ? post.tags.join(', ') : '');

// Convert ISO date for structured data
const publishedISO = new Date(post.publishedDate).toISOString();
const modifiedISO = new Date(post.updatedAt).toISOString();
---

<!doctype html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{pageTitle}</title>
    <meta name="description" content={pageDescription} />
    {keywords && <meta name="keywords" content={keywords} />}
    <meta name="author" content={post.author?.name} />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article" />
    <meta property="og:url" content={Astro.url.href} />
    <meta property="og:title" content={pageTitle} />
    <meta property="og:description" content={pageDescription} />
    <meta property="og:image" content={ogImage} />
    <meta property="article:published_time" content={publishedISO} />
    <meta property="article:modified_time" content={modifiedISO} />
    {post.author && <meta property="article:author" content={post.author.name} />}
    {post.categories && post.categories.map((category) => (
      <meta property="article:section" content={category.name} />
    ))}
    {post.tags && post.tags.map((tag: string) => (
      <meta property="article:tag" content={tag} />
    ))}

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={Astro.url.href} />
    <meta property="twitter:title" content={pageTitle} />
    <meta property="twitter:description" content={pageDescription} />
    <meta property="twitter:image" content={ogImage} />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700&family=Inter+Tight:wght@400;500;600;700;800;900&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />

    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalUrl} />

    <!-- Structured Data (Article) -->
    <script is:inline type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "headline": post.title,
      "description": post.excerpt,
      "image": ogImage,
      "datePublished": publishedISO,
      "dateModified": modifiedISO,
      "author": post.author ? {
        "@type": "Person",
        "name": post.author.name,
        ...(post.author.bio && { "description": post.author.bio }),
        ...(post.author.website && { "url": post.author.website })
      } : {
        "@type": "Person",
        "name": "Admin"
      },
      "publisher": {
        "@type": "Organization",
        "name": "HyFy",
        "logo": {
          "@type": "ImageObject",
          "url": `${Astro.url.origin}/logo.png`
        }
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": Astro.url.href
      },
      "keywords": post.tags ? post.tags.join(', ') : '',
      "wordCount": post.content.split(/\s+/).length,
      "timeRequired": `PT${post.readingTime}M`
    })} />

    <!-- Breadcrumb Structured Data -->
    <script is:inline type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": Astro.url.origin
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Blog",
          "item": `${Astro.url.origin}/blog`
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": post.title,
          "item": Astro.url.href
        }
      ]
    })} />
  </head>
  <body class="bg-obsidian text-white font-exo overflow-x-hidden">
    <!-- Global Header -->
    <GlobalHeader client:load currentPath={Astro.url.pathname} />

    <!-- Animated Background Grid -->
    <div class="fixed inset-0 pointer-events-none opacity-20">
      <div class="absolute inset-0"
           style="background-image: linear-gradient(#88FF66 1px, transparent 1px), linear-gradient(90deg, #88FF66 1px, transparent 1px); background-size: 50px 50px; opacity: 0.05;">
      </div>
    </div>

    <!-- Back Button -->
    <div class="fixed top-24 left-8 z-50">
      <a href="/blog"
         class="flex items-center gap-2 px-6 py-3 rounded-xl
                bg-white/[0.05] backdrop-blur-md border border-white/10
                hover:bg-lime/10 hover:border-lime/30
                hover:shadow-[0_0_15px_rgba(136,255,102,0.2)]
                transition-all duration-200 cursor-pointer group">
        <svg class="w-5 h-5 text-lime transition-transform duration-200 group-hover:-translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        <span class="font-semibold text-sm uppercase tracking-wide">Back to Blog</span>
      </a>
    </div>

    <!-- Article Header -->
    <article class="relative pt-40 pb-20">
      <!-- Enhanced Hero Section -->
      <div class="relative mb-20">
        <!-- Hero Image with Advanced Parallax and Effects -->
        <div class="relative h-[70vh] overflow-hidden rounded-3xl mx-4 sm:mx-6 lg:mx-8">
          <!-- Parallax Image Container -->
          <div class="absolute inset-0" data-parallax="0.5">
            <img
              src={imageUrl}
              alt={post.featuredImage?.alternativeText || post.title}
              class="w-full h-full object-cover scale-110 transition-transform duration-700"
            />
            <!-- Multi-layer Gradient Overlays -->
            <div class="absolute inset-0 bg-gradient-to-t from-obsidian via-obsidian/90 to-obsidian/30"></div>
            <div class="absolute inset-0 bg-gradient-to-br from-lime/5 via-transparent to-amber/5"></div>
          </div>

          <!-- Animated Glow Effects -->
          <div class="absolute bottom-0 left-1/3 -translate-x-1/2 w-[600px] h-[300px]
                      bg-lime/15 rounded-full blur-[120px] pointer-events-none animate-pulse-slow"></div>
          <div class="absolute top-1/4 right-1/4 w-[400px] h-[400px]
                      bg-amber/10 rounded-full blur-[100px] pointer-events-none animate-pulse-slow"
               style="animation-delay: 2s;"></div>

          <!-- Floating Geometric Elements -->
          <div class="absolute top-[15%] right-[10%] w-16 h-16 border border-lime/20 rounded-xl
                      backdrop-blur-sm bg-white/[0.02] animate-float-slow"
               style="animation-delay: 1s; transform: rotate(45deg);"></div>
          <div class="absolute bottom-[20%] left-[12%] w-12 h-12 border border-lime/15 rounded-lg
                      backdrop-blur-sm bg-white/[0.02] animate-float-slow"
               style="animation-delay: 3s; transform: rotate(-30deg);"></div>

          <!-- Content Overlay - Positioned at Bottom -->
          <div class="absolute bottom-0 left-0 right-0 p-8 md:p-12 lg:p-16">
            <!-- Glass Container for Meta Info -->
            <div class="max-w-5xl mx-auto">
              <!-- Breadcrumb -->
              <nav class="flex items-center gap-2 text-sm text-luminous-tertiary mb-6 animate-fade-in"
                   aria-label="Breadcrumb">
                <a href="/" class="hover:text-lime transition-colors duration-200">Home</a>
                <span>/</span>
                <a href="/blog" class="hover:text-lime transition-colors duration-200">Blog</a>
                <span>/</span>
                <span class="text-white truncate max-w-[200px]">{post.title}</span>
              </nav>

              <!-- Categories Pills -->
              {post.categories && post.categories.length > 0 && (
                <div class="flex flex-wrap gap-3 mb-6 animate-fade-in" style="animation-delay: 0.1s;">
                  {post.categories.map((category) => (
                    <a
                      href={`/blog?category=${category.slug}`}
                      class="group relative px-4 py-2 rounded-full text-xs font-bold uppercase tracking-widest
                             border-2 backdrop-blur-xl transition-all duration-300 hover:scale-110
                             hover:shadow-[0_0_20px_rgba(136,255,102,0.4)]"
                      style={`
                        background: ${category.color || '#88FF66'}20;
                        border-color: ${category.color || '#88FF66'};
                        color: ${category.color || '#88FF66'};
                      `}>
                      {category.name}
                      <!-- Shine effect on hover -->
                      <div class="absolute inset-0 rounded-full bg-gradient-to-r from-transparent via-white/20 to-transparent
                                  opacity-0 group-hover:opacity-100 transition-opacity duration-300"
                           style="transform: translateX(-100%); animation: shine 0.8s ease-in-out;"></div>
                    </a>
                  ))}
                </div>
              )}

              <!-- Title with Enhanced Styling -->
              <h1 class="font-orbitron font-bold text-3xl md:text-5xl lg:text-6xl xl:text-7xl mb-6
                         uppercase tracking-wide leading-[1.1] text-white
                         animate-fade-in-up"
                  style="animation-delay: 0.2s; text-shadow: 0 0 40px rgba(0,0,0,0.8), 0 0 80px rgba(136,255,102,0.1);">
                {post.title}
              </h1>

              <!-- Meta Information in Glass Panel -->
              <div class="flex flex-wrap items-center gap-4 p-6 rounded-2xl
                          bg-white/[0.05] backdrop-blur-xl border border-white/10
                          shadow-[0_8px_32px_rgba(0,0,0,0.4)]
                          animate-fade-in-up"
                   style="animation-delay: 0.3s;">
                <!-- Date -->
                <div class="flex items-center gap-2 text-luminous-tertiary hover:text-lime transition-colors duration-200">
                  <div class="p-2 rounded-lg bg-lime/10">
                    <svg class="w-5 h-5 text-lime" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                  </div>
                  <time datetime={post.publishedDate} class="font-medium">{formattedDate}</time>
                </div>

                <span class="text-lime/30">•</span>

                <!-- Author -->
                {post.author && (
                  <>
                    <div class="flex items-center gap-3 text-luminous-tertiary hover:text-lime transition-colors duration-200">
                      {post.author.avatar ? (
                        <img
                          src={getImageUrl(post.author.avatar)}
                          alt={post.author.name}
                          class="w-10 h-10 rounded-full object-cover border-2 border-lime/30"
                        />
                      ) : (
                        <div class="p-2 rounded-lg bg-lime/10">
                          <svg class="w-5 h-5 text-lime" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                          </svg>
                        </div>
                      )}
                      <span class="font-medium">{post.author.name}</span>
                    </div>
                    <span class="text-lime/30">•</span>
                  </>
                )}

                <!-- Reading Time Badge -->
                <div class="flex items-center gap-2 px-4 py-2 rounded-full
                            bg-gradient-to-r from-lime/20 to-lime/10 border border-lime/30
                            shadow-[0_0_15px_rgba(136,255,102,0.3)]">
                  <svg class="w-5 h-5 text-lime" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                  <span class="text-lime font-bold text-sm">{post.readingTime} MIN READ</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Vignette Effect -->
          <div class="absolute inset-0 pointer-events-none"
               style="box-shadow: inset 0 0 100px rgba(0,0,0,0.5), inset 0 0 200px rgba(0,0,0,0.3);"></div>
        </div>
      </div>

      <!-- Article Content Container -->
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Excerpt in Glass Panel -->
        <div class="relative p-8 rounded-2xl mb-12
                    bg-white/[0.03] backdrop-blur-xl border border-white/10
                    shadow-[0_8px_32px_rgba(0,0,0,0.3)]
                    animate-fade-in-up"
             style="animation-delay: 0.4s;">
          <!-- Decorative Corner Accent -->
          <div class="absolute top-0 left-0 w-20 h-20 border-t-2 border-l-2 border-lime/30 rounded-tl-2xl"></div>
          <div class="absolute bottom-0 right-0 w-20 h-20 border-b-2 border-r-2 border-lime/30 rounded-br-2xl"></div>

          <p class="text-luminous text-xl md:text-2xl leading-relaxed text-center font-light relative z-10">
            {post.excerpt}
          </p>
        </div>

        <!-- Tags -->
        {post.tags && post.tags.length > 0 && (
          <div class="flex flex-wrap gap-3 mb-12">
            {post.tags.map((tag: string) => (
              <span class="px-4 py-2 rounded-full text-sm font-medium
                           bg-white/[0.05] border border-white/10 text-lime
                           hover:bg-lime/10 hover:border-lime/30
                           transition-all duration-200">
                #{tag}
              </span>
            ))}
          </div>
        )}

        <!-- Article Content -->
        <div class="prose prose-invert prose-lg max-w-none mb-16
                    prose-headings:font-orbitron prose-headings:uppercase prose-headings:tracking-wide
                    prose-headings:text-white prose-headings:font-bold
                    prose-h1:text-4xl prose-h1:mt-16 prose-h1:mb-8
                    prose-h2:text-3xl prose-h2:mt-12 prose-h2:mb-6
                    prose-h3:text-2xl prose-h3:mt-8 prose-h3:mb-4
                    prose-h4:text-xl prose-h4:mt-6 prose-h4:mb-3
                    prose-p:text-luminous prose-p:leading-relaxed prose-p:mb-6
                    prose-a:text-lime prose-a:no-underline hover:prose-a:underline prose-a:transition-colors
                    prose-strong:text-white prose-strong:font-semibold
                    prose-em:text-luminous-tertiary prose-em:italic
                    prose-code:text-lime prose-code:bg-white/[0.05] prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm
                    prose-pre:bg-white/[0.03] prose-pre:border prose-pre:border-white/10 prose-pre:backdrop-blur-md prose-pre:p-6 prose-pre:rounded-xl prose-pre:overflow-x-auto
                    prose-blockquote:border-l-4 prose-blockquote:border-lime prose-blockquote:pl-6 prose-blockquote:italic prose-blockquote:text-luminous-tertiary prose-blockquote:bg-white/[0.02] prose-blockquote:py-4 prose-blockquote:rounded-r-xl
                    prose-ul:text-luminous prose-ul:my-6 prose-ul:space-y-2
                    prose-ol:text-luminous prose-ol:my-6 prose-ol:space-y-2
                    prose-li:mb-2 prose-li:marker:text-lime
                    prose-img:rounded-2xl prose-img:shadow-[0_0_30px_rgba(136,255,102,0.1)] prose-img:my-8 prose-img:w-full
                    prose-hr:border-white/10 prose-hr:my-12
                    prose-table:border prose-table:border-white/10 prose-table:rounded-xl prose-table:overflow-hidden
                    prose-thead:bg-white/[0.05]
                    prose-th:border prose-th:border-white/10 prose-th:p-4 prose-th:text-lime
                    prose-td:border prose-td:border-white/10 prose-td:p-4">
          <Fragment set:html={contentHtml} />
        </div>

        <!-- Share Section -->
        <div class="p-8 rounded-2xl bg-white/[0.03] backdrop-blur-md border border-white/10 mb-16">
          <h3 class="font-orbitron font-semibold text-xl mb-4 uppercase">Share this article</h3>
          <div class="flex flex-wrap gap-3">
            <a
              href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(post.title)}&url=${encodeURIComponent(Astro.url.href)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="flex items-center gap-2 px-6 py-3 rounded-xl
                     bg-white/[0.05] border border-white/10 hover:border-lime/30
                     hover:bg-lime/10 transition-all duration-200 cursor-pointer group">
              <svg class="w-5 h-5 text-lime" fill="currentColor" viewBox="0 0 24 24">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
              <span class="font-semibold text-sm group-hover:text-lime transition-colors duration-200">Twitter</span>
            </a>
            <a
              href={`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(Astro.url.href)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="flex items-center gap-2 px-6 py-3 rounded-xl
                     bg-white/[0.05] border border-white/10 hover:border-lime/30
                     hover:bg-lime/10 transition-all duration-200 cursor-pointer group">
              <svg class="w-5 h-5 text-lime" fill="currentColor" viewBox="0 0 24 24">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
              <span class="font-semibold text-sm group-hover:text-lime transition-colors duration-200">Facebook</span>
            </a>
            <a
              href={`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(Astro.url.href)}&title=${encodeURIComponent(post.title)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="flex items-center gap-2 px-6 py-3 rounded-xl
                     bg-white/[0.05] border border-white/10 hover:border-lime/30
                     hover:bg-lime/10 transition-all duration-200 cursor-pointer group">
              <svg class="w-5 h-5 text-lime" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
              <span class="font-semibold text-sm group-hover:text-lime transition-colors duration-200">LinkedIn</span>
            </a>
          </div>
        </div>

        <!-- Author Bio -->
        {post.author && post.author.bio && (
          <div class="p-8 rounded-2xl bg-white/[0.03] backdrop-blur-md border border-white/10 mb-16">
            <div class="flex gap-6 items-start">
              {post.author.avatar && (
                <img
                  src={getImageUrl(post.author.avatar)}
                  alt={post.author.name}
                  class="w-20 h-20 rounded-full object-cover border-2 border-lime/30"
                />
              )}
              <div class="flex-1">
                <h3 class="font-orbitron font-semibold text-xl mb-2 uppercase">About {post.author.name}</h3>
                <p class="text-luminous-tertiary mb-4">{post.author.bio}</p>
                <div class="flex gap-4">
                  {post.author.twitter && (
                    <a
                      href={`https://twitter.com/${post.author.twitter.replace('@', '')}`}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="text-lime hover:text-lime/80 transition-colors duration-200">
                      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                      </svg>
                    </a>
                  )}
                  {post.author.linkedin && (
                    <a
                      href={post.author.linkedin}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="text-lime hover:text-lime/80 transition-colors duration-200">
                      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                      </svg>
                    </a>
                  )}
                  {post.author.website && (
                    <a
                      href={post.author.website}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="text-lime hover:text-lime/80 transition-colors duration-200">
                      <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
                      </svg>
                    </a>
                  )}
                </div>
              </div>
            </div>
          </div>
        )}

        <!-- Related Posts -->
        {post.relatedPosts && post.relatedPosts.length > 0 && (
          <div class="mb-16">
            <h3 class="font-orbitron font-semibold text-2xl mb-6 uppercase">Related Articles</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {post.relatedPosts.map((relatedPost) => (
                <a
                  href={`/blog/${relatedPost.slug}`}
                  class="group p-6 rounded-2xl bg-white/[0.03] backdrop-blur-md border border-white/10
                         hover:bg-white/[0.05] hover:border-lime/30 transition-all duration-300">
                  {relatedPost.featuredImage && (
                    <img
                      src={getImageUrl(relatedPost.featuredImage)}
                      alt={relatedPost.title}
                      class="w-full h-40 object-cover rounded-xl mb-4"
                    />
                  )}
                  <h4 class="font-orbitron font-semibold text-lg mb-2 group-hover:text-lime transition-colors duration-200">
                    {relatedPost.title}
                  </h4>
                  <p class="text-luminous-tertiary text-sm mb-3 line-clamp-2">{relatedPost.excerpt}</p>
                  <div class="flex items-center gap-3 text-xs text-luminous-tertiary">
                    <span>{formatDate(relatedPost.publishedDate)}</span>
                    <span>•</span>
                    <span>{relatedPost.readingTime} min read</span>
                  </div>
                </a>
              ))}
            </div>
          </div>
        )}

        <!-- Back to Blog -->
        <div class="text-center">
          <a href="/blog"
             class="inline-flex items-center gap-3 px-8 py-4 rounded-xl
                    bg-lime text-[#050505] font-semibold uppercase tracking-wide
                    hover:bg-lime/90 transition-all duration-200 cursor-pointer
                    shadow-[0_0_20px_rgba(136,255,102,0.4)] hover:shadow-[0_0_30px_rgba(136,255,102,0.6)]">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
            </svg>
            Back to All Articles
          </a>
        </div>
      </div>
    </article>

    <style>
      @font-face {
        font-family: 'Exo 2';
        font-display: swap;
      }

      @font-face {
        font-family: 'Orbitron';
        font-display: swap;
      }

      .font-exo {
        font-family: 'Exo 2', sans-serif;
      }

      .font-orbitron {
        font-family: 'Orbitron', sans-serif;
      }

      /* Floating Animation */
      @keyframes float {
        0%, 100% {
          transform: translateY(0px) translateX(0px);
        }
        25% {
          transform: translateY(-20px) translateX(10px);
        }
        50% {
          transform: translateY(-10px) translateX(-10px);
        }
        75% {
          transform: translateY(-15px) translateX(5px);
        }
      }

      .animate-float-slow {
        animation: float 12s ease-in-out infinite;
      }

      /* Pulse Animation */
      @keyframes pulseSlow {
        0%, 100% {
          opacity: 0.3;
        }
        50% {
          opacity: 0.6;
        }
      }

      .animate-pulse-slow {
        animation: pulseSlow 4s ease-in-out infinite;
      }

      /* Fade In Animations */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(40px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .animate-fade-in {
        animation: fadeIn 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        opacity: 0;
      }

      .animate-fade-in-up {
        animation: fadeInUp 1s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        opacity: 0;
      }

      /* Shine Effect */
      @keyframes shine {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(200%);
        }
      }

      @media (prefers-reduced-motion: reduce) {
        * {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }
    </style>

    <script>
      // Parallax effect for hero image
      const parallaxElements = document.querySelectorAll<HTMLElement>('[data-parallax]');

      window.addEventListener('scroll', () => {
        const scrolled = window.pageYOffset;

        parallaxElements.forEach((el) => {
          const speed = parseFloat(el.getAttribute('data-parallax') || '0.5');
          const yPos = -(scrolled * speed);
          el.style.transform = `translateY(${yPos}px)`;
        });
      });
    </script>
  </body>
</html>
